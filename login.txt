Imports System.Windows.Forms.VisualStyles.VisualStyleElement.StartPanel
Imports MySql.Data.MySqlClient

Public Class Form1
    Private connectionString As String = "server=localhost;username=root;password=101010;database=automanager"

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim username As String = TextBox1.Text
        Dim password As String = TextBox2.Text

        ' Create a MySqlConnection object to connect to MySQL database
        Using conn As New MySqlConnection(connectionString)
            Try
                ' Open the database connection
                conn.Open()

                ' SQL query to check if username and password exist in the database
                Dim query As String = "SELECT COUNT(*) FROM admin WHERE username = @username AND password = @password"
                Dim cmd As New MySqlCommand(query, conn)
                cmd.Parameters.AddWithValue("@username", username)
                cmd.Parameters.AddWithValue("@password", password)

                ' Execute the query and get the result
                MessageBox.Show("login Successful", "Success", MessageBoxButtons.OK, MessageBoxIcon.Information)
                Dim result As Integer = Convert.ToInt32(cmd.ExecuteScalar())

                ' If result is greater than 0, login successful
                If result > 0 Then
                    Form2.Show()
                    Me.Hide()
                    ' Redirect to another form or perform other actions upon successful login
                Else
                    MessageBox.Show("Invalid username or password. Please try again.", "Warning", MessageBoxButtons.OK, MessageBoxIcon.Warning)
                End If
            Catch ex As Exception
                MessageBox.Show("Error: " & ex.Message)
            End Try
        End Using
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        TextBox1.Text = ""
        TextBox2.Text = ""

    End Sub
    Private Sub textbox1_textchanged(sender As Object, e As EventArgs) Handles TextBox1.TextChanged
        If Not String.IsNullOrEmpty(TextBox1.Text) AndAlso Not TextBox1.Text.All(Function(c) Char.IsLetter(c)) Then
            MessageBox.Show("Error: Only alphabets are allowed in Username", "Warning", MessageBoxButtons.OK, MessageBoxIcon.Warning)
            TextBox1.Text = ""
        End If
    End Sub
    Private Sub textbox2_textchanged(sender As Object, e As EventArgs)
        If Not String.IsNullOrEmpty(TextBox2.Text) AndAlso Not TextBox2.Text.All(Function(c) Char.IsDigit(c)) Then
            MessageBox.Show("Error: Only numbers are allowed in Password", "Warning", MessageBoxButtons.OK, MessageBoxIcon.Warning)
            TextBox2.Text = ""
        End If
    End Sub

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Me.WindowState = FormWindowState.Maximized
    End Sub
End Class